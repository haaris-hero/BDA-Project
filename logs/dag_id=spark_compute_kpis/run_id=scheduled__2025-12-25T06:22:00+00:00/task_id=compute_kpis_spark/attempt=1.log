[2025-12-25T06:24:22.165+0000] {taskinstance.py:1087} INFO - Dependencies all met for <TaskInstance: spark_compute_kpis.compute_kpis_spark scheduled__2025-12-25T06:22:00+00:00 [queued]>
[2025-12-25T06:24:22.179+0000] {taskinstance.py:1087} INFO - Dependencies all met for <TaskInstance: spark_compute_kpis.compute_kpis_spark scheduled__2025-12-25T06:22:00+00:00 [queued]>
[2025-12-25T06:24:22.179+0000] {taskinstance.py:1283} INFO - 
--------------------------------------------------------------------------------
[2025-12-25T06:24:22.179+0000] {taskinstance.py:1284} INFO - Starting attempt 1 of 2
[2025-12-25T06:24:22.180+0000] {taskinstance.py:1285} INFO - 
--------------------------------------------------------------------------------
[2025-12-25T06:24:22.197+0000] {taskinstance.py:1304} INFO - Executing <Task(PythonOperator): compute_kpis_spark> on 2025-12-25 06:22:00+00:00
[2025-12-25T06:24:22.207+0000] {standard_task_runner.py:55} INFO - Started process 176 to run task
[2025-12-25T06:24:22.213+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'spark_compute_kpis', 'compute_kpis_spark', 'scheduled__2025-12-25T06:22:00+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/dag_spark_kpi_computation.py', '--cfg-path', '/tmp/tmp66cxuip4']
[2025-12-25T06:24:22.215+0000] {standard_task_runner.py:83} INFO - Job 5: Subtask compute_kpis_spark
[2025-12-25T06:24:22.362+0000] {task_command.py:389} INFO - Running <TaskInstance: spark_compute_kpis.compute_kpis_spark scheduled__2025-12-25T06:22:00+00:00 [running]> on host 5d2d0ac3fe6f
[2025-12-25T06:24:22.492+0000] {local_task_job.py:82} ERROR - Received SIGTERM. Terminating subprocesses
[2025-12-25T06:24:22.496+0000] {process_utils.py:133} INFO - Sending Signals.SIGTERM to group 176. PIDs of all processes in the group: [176]
[2025-12-25T06:24:22.496+0000] {process_utils.py:84} INFO - Sending the signal Signals.SIGTERM to group 176
[2025-12-25T06:24:22.496+0000] {taskinstance.py:1483} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-12-25T06:24:22.595+0000] {taskinstance.py:1772} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1378, in _run_raw_task
    self._execute_task_with_callbacks(context, test_mode)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1500, in _execute_task_with_callbacks
    RenderedTaskInstanceFields.write(rtif)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 75, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/renderedtifields.py", line 183, in write
    session.merge(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 3057, in merge
    _resolve_conflict_map=_resolve_conflict_map,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 3135, in _merge
    options=options,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 2856, in get
    execution_options=execution_options,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 2974, in _get_impl
    load_options=load_options,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/loading.py", line 534, in load_on_pk_identity
    bind_arguments=bind_arguments,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/session.py", line 1714, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 335, in _execute_on_connection
    self, multiparams, params, execution_options
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1570, in _execute_clauseelement
    linting=self.dialect.compiler_linting | compiler.WARN_LINTING,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 538, in _compile_w_cache
    **kw
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 567, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/compiler.py", line 804, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/compiler.py", line 463, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/compiler.py", line 498, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/visitors.py", line 82, in _compiler_dispatch
    return meth(self, **kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/compiler.py", line 3318, in visit_select
    select_stmt, self, **kwargs
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/base.py", line 510, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/context.py", line 765, in create_for_statement
    self._setup_for_generate()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/context.py", line 879, in _setup_for_generate
    strategy(self, *rec[1:])
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/strategies.py", line 2352, in _create_eager_join
    path, towrap, clauses, onclause, extra_join_criteria
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/strategies.py", line 2461, in _splice_nested_inner_join
    _left_memo=join_obj._left_memo,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/orm/util.py", line 1796, in __init__
    expression.Join.__init__(self, left, right, onclause, isouter, full)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/selectable.py", line 1006, in __init__
    roles.FromClauseRole, right, deannotate=True
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/selectable.py", line 1120, in self_group
    return FromGrouping(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/selectable.py", line 2609, in __init__
    self.element = coercions.expect(roles.FromClauseRole, element)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1485, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2025-12-25T06:24:22.706+0000] {taskinstance.py:1327} INFO - Marking task as UP_FOR_RETRY. dag_id=spark_compute_kpis, task_id=compute_kpis_spark, execution_date=20251225T062200, start_date=20251225T062422, end_date=20251225T062422
[2025-12-25T06:24:22.907+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 5 for task compute_kpis_spark (Task received SIGTERM signal; 176)
[2025-12-25T06:24:22.939+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=176, status='terminated', exitcode=1, started='06:24:21') (176) terminated with exit code 1
[2025-12-25T06:24:22.940+0000] {local_task_job.py:159} INFO - Task exited with return code 143
[2025-12-25T06:24:23.038+0000] {taskinstance.py:2582} INFO - 0 downstream tasks scheduled from follow-on schedule check
